<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>Y&L恋爱日记</title>
  <style>
    :root{
      /* ===== 核心配色 ===== */
      --bg0:#050915;
      --bg1:#0b1630;
      --panel:#0f1732cc;
      --stroke:#2b3768;
      --stroke2:#16214a;
      --ink:#eaf0ff;
      --muted:#b9c6ff;
      --pink:#ff6fb1;
      --blue:#5dbbff;

      /* 对话框 */
      --dialog-bg:#1a223bcc;
      --dialog-stroke:#eaf0ff;
      --dialog-title:#eaf0ff;
      --dialog-text:#eaf0ff;

      /* 顶部日期牌 */
      --tag-bg:#313a55;
      --tag-stroke:#eaf0ff;
      --tag-ink:#ffd66e;

      /* 按钮 */
      --btn-bg:#141c33cc;
      --btn-stroke:#eaf0ff;
      --btn-ink:#eaf0ff;
      --btn-left:#b7b3ff;
      --btn-right:#ffb6d9;
    }

    html,body{height:100%;width:100%;margin:0;background:var(--bg0);overflow:hidden;}
    body{
      font-family: ui-sans-serif, system-ui, -apple-system, "PingFang SC","Microsoft YaHei", sans-serif;
      color:var(--ink);
      -webkit-tap-highlight-color: transparent;
    }

    /* ===== 全屏舞台 ===== */
    .stage{
      position:fixed;
      inset:0;
      background:
        radial-gradient(1200px 800px at 30% 20%, rgba(93,187,255,.10), transparent 55%),
        radial-gradient(900px 700px at 70% 35%, rgba(255,111,177,.10), transparent 60%),
        linear-gradient(180deg, var(--bg1), var(--bg0));
    }

    /* ===== 云朵像素风“点阵雾”叠加 ===== */
    .clouds{
      position:absolute; inset:0;
      pointer-events:none;
      opacity:.55;
      background:
        radial-gradient(circle at 15% 20%, rgba(255,255,255,.10) 0 35px, transparent 36px),
        radial-gradient(circle at 30% 18%, rgba(255,255,255,.08) 0 44px, transparent 45px),
        radial-gradient(circle at 55% 22%, rgba(255,255,255,.09) 0 52px, transparent 53px),
        radial-gradient(circle at 78% 16%, rgba(255,255,255,.08) 0 46px, transparent 47px),
        radial-gradient(circle at 20% 55%, rgba(255,255,255,.06) 0 55px, transparent 56px),
        radial-gradient(circle at 65% 60%, rgba(255,255,255,.05) 0 65px, transparent 66px);
      filter: blur(.2px);
      z-index: 2;
    }
    .clouds::after{
      content:"";
      position:absolute; inset:0;
      background-image:
        radial-gradient(rgba(255,255,255,.04) 1px, transparent 1px);
      background-size: 6px 6px;
      opacity:.9;
      mix-blend-mode: screen;
    }

    /* ===== 页面容器 ===== */
    .page{
      position:absolute; inset:0;
      display:none;
      z-index: 1;
    }
    .page.active{display:block;}

    /* 图片全屏铺满 */
    .image-container{
      position:absolute; inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
    }
    .pixel-image{
      width: 100%;
      height: 100%;
      object-fit: cover;
      image-rendering: pixelated;
      image-rendering: crisp-edges;
    }

    /* ===== 顶部“日期牌” ===== */
    .top-tag{
      position:absolute;
      top: max(20px, env(safe-area-inset-top));
      left:50%;
      transform:translateX(-50%);
      padding: 10px 14px;
      background: var(--tag-bg);
      border: 3px solid var(--tag-stroke);
      border-radius: 10px;
      box-shadow: 0 10px 22px rgba(0,0,0,.35);
      font-weight: 800;
      letter-spacing: .5px;
      color: var(--tag-ink);
      text-align:center;
      min-width: 180px;
      z-index: 10;
    }
    .top-tag small{
      display:block;
      font-weight: 700;
      color: rgba(255,214,110,.95);
      margin-top: 2px;
      letter-spacing: 0;
      font-size: 0.9em;
    }

    /* ===== 左右翻页按钮 ===== */
    .nav{
      position:absolute;
      inset:0;
      pointer-events:none;
      z-index: 20;
    }
    .nav-btn{
      pointer-events:auto;
      position:absolute;
      top:50%;
      transform:translateY(-50%);
      width: 54px;
      height: 54px;
      border-radius: 12px;
      background: var(--btn-bg);
      border: 3px solid var(--btn-stroke);
      box-shadow: 0 10px 22px rgba(0,0,0,.35);
      display:flex;
      align-items:center;
      justify-content:center;
      user-select:none;
      cursor:pointer;
      transition: transform .12s ease, filter .12s ease;
    }
    .nav-btn:active{ transform:translateY(-50%) scale(.97); }
    .nav-left{ left: 14px; background: color-mix(in oklab, var(--btn-bg) 75%, var(--btn-left) 25%); }
    .nav-right{ right: 14px; background: color-mix(in oklab, var(--btn-bg) 75%, var(--btn-right) 25%); }
    .nav-btn span{
      font-size: 26px;
      line-height: 1;
      color: var(--btn-ink);
      text-shadow: 0 2px 0 rgba(0,0,0,.35);
    }

    /* ===== 底部对话框 ===== */
    .dialog{
      position:absolute;
      left: 12px;
      right: 12px;
      /* 底部留空给重播按钮 */
      bottom: calc(max(20px, env(safe-area-inset-bottom)) + 50px);
      background: var(--dialog-bg);
      border: 3px solid var(--dialog-stroke);
      border-radius: 16px;
      box-shadow: 0 18px 40px rgba(0,0,0,.42);
      overflow:hidden;
      transform: translateY(130%);
      opacity: 0;
      z-index: 15;
      backdrop-filter: blur(4px);
    }
    .dialog.show{
      animation: dialogUp .38s cubic-bezier(.2,.9,.2,1) forwards;
    }
    @keyframes dialogUp{
      from{ transform: translateY(130%); opacity: 0; }
      to  { transform: translateY(0%);   opacity: 1; }
    }

    .dialog-inner{ padding: 14px 14px 16px; }
    
    .dialog-title{
      font-weight: 900;
      font-size: 18px;
      color: var(--dialog-title);
      margin-bottom: 10px;
      display:flex;
      align-items:center; /* 保持并排垂直居中 */
      gap:10px;
    }
    .dialog-title .dot{
      width: 10px; height: 10px; border-radius: 999px;
      background: var(--pink);
      box-shadow: 0 0 0 3px rgba(255,111,177,.18);
      flex: 0 0 auto;
    }
    .dialog-text{
      font-size: 15px;
      line-height: 1.75;
      color: var(--dialog-text);
      white-space: pre-wrap; /* 核心：保留文案中的换行符 */
      min-height: 3.2em;
    }

    /* HUD: 仅保留重播按钮，置底居中 */
    .hud{
      position:absolute;
      left: 0;
      right: 0;
      bottom: max(20px, env(safe-area-inset-bottom));
      display:flex;
      justify-content:center;
      pointer-events:none;
      z-index: 10;
    }
    .pill{
      pointer-events:auto;
      padding: 6px 14px;
      border-radius: 999px;
      background: var(--panel);
      border: 1px solid rgba(234,240,255,.22);
      box-shadow: 0 10px 22px rgba(0,0,0,.25);
      font-size: 12px;
      color: var(--muted);
      user-select:none;
    }
    .pill button{
      all: unset;
      cursor:pointer;
      font-weight: 800;
      color: var(--ink);
    }
  </style>
</head>

<body>
  <div class="stage">
    <div class="clouds"></div>

    <div id="pagesRoot"></div>

    <div class="nav">
      <div class="nav-btn nav-left" id="btnPrev" aria-label="上一页"><span>←</span></div>
      <div class="nav-btn nav-right" id="btnNext" aria-label="下一页"><span>→</span></div>
    </div>

    <div class="hud">
      <div class="pill"><button id="btnReplay">↺ 重播本页</button></div>
    </div>
  </div>

  <script>
    // 1. 图片路径配置
    const IMAGES = Array.from({length: 14}, (_, i) => `assets/${i+1}.png`);

    // 2. 顶部日期/地点标签数据
    const TOP_TAGS = [
      { main: "2026.2.14", sub: "第一个情人节" },
      { main: "2025年3月", sub: " 初遇&二教自习室" },
      { main: "2025.6.20", sub: "路灯下 加了微信" },
      { main: "2025.6.22", sub: "一起去鬼屋" },
      { main: "2025.11.25", sub: "回国&再次相遇" },
      { main: "2025.11.27", sub: "路灯下 聊了一整夜" },
      { main: "2025.12.4 ", sub: "在一起&小王子鲜花" },
      { main: "2025.12.5", sub: "二教楼下&初吻" },
      { main: "2025.12.6", sub: "海底捞&通宵火锅" },
      { main: "2025.12.6", sub: "机场&吻别" },
      { main: "未来", sub: "Y&L一起吃早餐" },
      { main: "未来", sub: "Y&L三餐四季" },
      { main: "未来", sub: "Y&L一起睡觉" },
      { main: "Y&L恋爱日记", sub: "continuing…" },
    ];

    // 3. 底部对话框文字数据 (已修复换行与标点，优化排版)
    const PAGES_DATA = [
      {
        title: "在一起第 71 天",
        text: `罗云浩 & 易浩哲。
这是我们在一起的第 71 天，
也是我们一起过的第一个情人节。

原来两个人在一起以后，
日子不会突然变成电影——
它只是多了一种很踏实的温柔：
有人听你碎碎念，有人把你放在心上。

所以我想送你一份不太一样的礼物：
把我们的瞬间写成故事。
这故事开始一个人，
我认真写成了我们。`
      },
      {
        title: "二教自习室初遇 | 第一眼就记住了",
        text: `我依旧记得第一次见你的样子。
你背着书包、抱着电脑走进来，
像刚下过雨的天空一样干净。
你看起来有点稚气，我甚至以为你是大一大二的学生，
那种“还没被生活磨钝”的少年感，
让人忍不住多看一眼。

二教自习室的灯很白，四周很安静，
可我偏偏记住了你抬眼那一下的温柔。
原来“遇见”不是轰轰烈烈，
是心里轻轻“咚”了一下——
然后再也没完全恢复原样。`
      },
      {
        title: "路灯下加微信 | 故事有了入口",
        text: `我一直觉得自己不太会主动，
可那天走到路灯下，我还是鼓起勇气把手机递过去。

我突然有一种很奇妙的感觉：
原来世界真的会回我消息。
从那天起，晚风、路灯、影子、
还有“你在不在”这四个字，
就变成了我生活里最温柔的开场白。
我们的故事，终于有了一个可以反复回到的入口。`
      },
      {
        title: "一起玩鬼屋 | 害怕也想靠近你",
        text: `鬼屋里黑得像把心跳放大了十倍。
其实鬼屋没那么可怕。
可怕的是我会在黑暗里下意识去抓你的衣角，
然后发现我抓到的不是布料，是安全感。

我一边嘴硬，一边把手心攥得发烫。
你走在我旁边，让我觉得——
原来“害怕”的反义词不是勇敢，
是有人在身边。`
      },
      {
        title: "回国 | 自习室再次相遇",
        text: `你回国那天，
我站在教室门外，看见你的一瞬间，
脑子甚至空白了两秒。
我不敢相信自己的眼睛，来来回回看了你好几次，
像在确认这是不是幻觉：你真的回来了。
那一刻我心里冒出来的不是“好久不见”，
而是一个更轻、更傻的念头——
太好了，你还在。

后来我才知道，
那不是重逢，
那是我们故事的第二次开场。`
      },
      {
        title: "路灯下畅聊一整夜 | 误会被温柔拆开",
        text: `那一晚路灯很亮，
亮到我终于敢把心里没说完的话都说出来。
那一晚我们聊了很久很久。
误会被一句句拆开，像打结的线终于慢慢被解开。
夜很深，路灯很亮，我们却比白天更清醒。

从午夜，到天色微亮，
原来喜欢一个人，
会让人愿意卸下所有防备。`
      },
      {
        title: "小王子鲜花 | 从一束花开始更认真",
        text: `12.4，我们在一起了。
那天我送你一束“小王子”。
我突然想起那句话：
也许世界上有五千朵和你一样的花，
可只有你，是我独一无二的玫瑰。

你倾听她的怨艾和自诩，
你甚至聆听她的沉默。
你在你的玫瑰上耗费的时间，
使得你的玫瑰变得如此重要。`
      },
      {
        title: "二教楼下初吻 | 那一秒世界变安静",
        text: `二教楼下的风很轻，
我却像用了全身的勇气。
我们都很青涩，
像两个人第一次学着把“喜欢”落到现实里。

但那一秒，世界忽然安静到只剩心跳。
你看着我，就是最美的回应。`
      },
      {
        title: "海底捞通宵火锅 | 把夜晚吃成家常",
        text: `我们在海底捞吃到深夜，
把一顿火锅吃成了“家常”。
沸腾的汤底、热气和笑声，把冬天都煮得很暖。
以后再长的夜，只要和你一起，都会变得好过。

所谓幸福不是惊天动地，
是有人愿意和你一起熬夜，
还把你当作最重要的那一口。`
      },
      {
        title: "机场吻别 | 把思念先存起来",
        text: `机场的广播一遍遍响起，
人群来来往往，
我们却像被按下了慢放。

那个吻像是一次约定：
不是告别，
是把思念先存起来，
等我们下次见面，
再一次性兑现。`
      },
      {
        title: "未来 | 一起吃早餐",
        text: `我想要的未来其实很简单。
早上醒来，有人问我：要不要加个蛋？
我们穿着拖鞋在厨房里走来走去，
阳光落在桌面上，
你随口说一句今天也要加油。

那种“平凡”的画面，
是我现在最向往的浪漫。
因为和你在一起，
连日常都像被认真对待。`
      },
      {
        title: "未来 | 一起吃饭",
        text: `我想和你一起吃很多很多顿饭。
不是因为饭有多好吃，
而是因为你在，
就会变得很好吃。

我们可以吃得很简单：
一碗面、一份饭，你夹给我一块我爱吃的菜。
也可以吃得很隆重：
庆祝每一个小小的成就。
只要是和你一起，我就会觉得——
生活值得被期待。`
      },
      {
        title: "未来 | 晚安是偏爱",
        text: `我想和你住在同一个屋檐下。
为了每个夜晚，都能把“晚安”说给你听。
灯关掉以后，你在我身边呼吸的声音，
会让我觉得特别踏实。

我想在你累的时候抱抱你，
在你烦的时候亲亲你，
在你睡着的时候悄悄说一句：
谢谢你来到我身边。`
      },
      {
        title: "故事 continuing…",
        text: `回头看才发现，
我们的故事越写越长了。
从二教的灯光、路灯下的勇气，
到火锅的热气、机场的拥抱，
每一页都在把我们变成更坚定的我们。

我以前总觉得“未来”很远，
可现在我发现，
未来其实就是——
下一次见面，下一顿饭，下一句晚安。
故事 continuing。
下一页，是我们一起过的每一天。`
      }
    ];

    // 初始化：生成 HTML 结构
    const pagesRoot = document.getElementById('pagesRoot');
    const total = 14;

    PAGES_DATA.forEach((_, i) => {
      const idx = i + 1;
      const section = document.createElement('section');
      section.className = 'page';
      section.id = `page${idx}`;
      section.innerHTML = `
        <div class="image-container">
          <img class="pixel-image" id="img${idx}" src="${IMAGES[i]}" alt="page${idx}">
        </div>
        <div class="top-tag" id="tag${idx}"></div>
        <div class="dialog" id="dialog${idx}">
          <div class="dialog-inner">
            <div class="dialog-title">
              <span class="dot"></span>
              <span id="title${idx}"></span>
            </div>
            <div class="dialog-text" id="text${idx}"></div>
          </div>
        </div>
      `;
      pagesRoot.appendChild(section);
    });

    // 逻辑控制
    let current = 1;
    let typingTimer = null;

    const btnPrev = document.getElementById("btnPrev");
    const btnNext = document.getElementById("btnNext");
    const btnReplay = document.getElementById("btnReplay");

    // 打字机效果
    function typeWriter(el, text, speed=22){
      clearInterval(typingTimer);
      el.textContent = "";
      let idx = 0;
      typingTimer = setInterval(()=>{
        el.textContent += text[idx] ?? "";
        idx++;
        if(idx >= text.length) clearInterval(typingTimer);
      }, speed);
    }

    // 播放页面动画
    function startPageAnimation(n){
      clearInterval(typingTimer);
      const dialog = document.getElementById(`dialog${n}`);
      const textEl = document.getElementById(`text${n}`);

      // 重置状态
      dialog.classList.remove("show");
      void dialog.offsetWidth; // 强制重排
      textEl.textContent = "";

      // 延迟弹出并打字
      setTimeout(()=>{
        dialog.classList.add("show");
        setTimeout(()=> typeWriter(textEl, PAGES_DATA[n-1].text, 18), 220);
      }, 120);
    }

    // 切换页面核心函数
    function showPage(n){
      n = Math.max(1, Math.min(total, n));

      // 切换 DOM 显示
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      const curPage = document.getElementById(`page${n}`);
      curPage.classList.add('active');
      current = n;

      // 更新当前页的标签和标题
      const tag = TOP_TAGS[n-1];
      document.getElementById(`tag${n}`).innerHTML = `${tag.main}<small>${tag.sub}</small>`;
      document.getElementById(`title${n}`).textContent = PAGES_DATA[n-1].title;

      // 执行动画
      startPageAnimation(n);

      // 控制按钮显隐
      btnPrev.style.display = (current===1) ? "none" : "flex";
      btnNext.style.display = (current===total) ? "none" : "flex";
    }

    // 事件绑定
    function nextPage(){ showPage(current + 1); }
    function prevPage(){ showPage(current - 1); }
    function replayPage(){ startPageAnimation(current); }

    btnNext.addEventListener("click", nextPage);
    btnPrev.addEventListener("click", prevPage);
    btnReplay.addEventListener("click", replayPage);

    // 触摸滑动支持
    let startX = null;
    window.addEventListener("touchstart", (e)=>{
      startX = e.touches?.[0]?.clientX ?? null;
    }, {passive:true});
    window.addEventListener("touchend", (e)=>{
      if(startX===null) return;
      const endX = e.changedTouches?.[0]?.clientX ?? startX;
      const dx = endX - startX;
      startX = null;
      if(Math.abs(dx) < 45) return;
      if(dx < 0) nextPage();
      else prevPage();
    }, {passive:true});

    // 键盘支持
    window.addEventListener("keydown",(e)=>{
      if(e.key==="ArrowRight") nextPage();
      if(e.key==="ArrowLeft") prevPage();
      if(e.key==="r" || e.key==="R") replayPage();
    });

    // 启动
    showPage(1);
  </script>
</body>
</html>